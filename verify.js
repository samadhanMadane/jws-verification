var jose = require('node-jose');
var fs = require('fs');
var data = fs.readFileSync("./penetolabs_privatekey.txt");

keystore = jose.JWK.createKeyStore();

// var newPublicKey = fs.readFileSync("./publickey.txt");
// var jusPayPublicKey = fs.readFileSync("./juspay-publickey.txt");
// keystore.add(newPublicKey, "pem", {kid : 'ajdhcce2-7522-414d-bff7-6ecf132db345'});
// keystore.add(jusPayPublicKey, "pem", {kid : 'tCyXQtYmeQDAhEKKPcrfFQzhgpqPpDHy'});

var penetolabsPublicKey = fs.readFileSync("./penetolabs_publickey.txt");;
keystore.add(penetolabsPublicKey, "pem", {kid : 'a0115cb8-0d3a-11eb-adc1-0242ac120002'});

var object1 = JSON.parse('{"FintechOfferAvailabilityRequest":{"FintechRequest":{"Identifier_Value":"AAIPP9511K","Mobile_no":"9966554433","SourceName":"","Identifier_Name":"PAN_NO","Transaction_refno":"020520201107","Product_name":"OD","Partner_name":"Softcell"},"soaStandard":{"service_user":"string","service_password":"string","consumer_name":"string","unique_id":"string","time_stamp":"string"},"CPRequest":{"customer_key2":"","ignore_source_restriction":"T","channel":"BA","source":"OFR","additional_filter":"","security_key":"c09f1cb9a5046d6083e1a84d62f8dcc1","customer_key":"","bypass_open_n_click_check":"T","partner_tracking_id":"","preferred_language_only":"T","organization_id":"10000","personalization_required":"T","session_key":"","partner_code":"","flow_point":"","specified_source_only":"F","content_count":"0","business_id":"50082","customer_code":"93299392020162408691","preferred_language":"ENG"},"soaFillers":{"filler9":"string","filler8":"string","filler5":"string","filler4":"string","filler7":"string","filler6":"string","filler1":"string","filler10":"string","filler3":"string","filler2":"string"}}}'); 
console.log("object1: ", object1);

let thePayload = '{"metadata":{"version":"3.3","timestamp":"2020-09-05T09:35:39.379Z","traceId":"a8cc6822bd4bbb4eb1b9e1b4996fbffuat1","orgId":"FIU_HDFC_BANK"},"response":{"error":"0"},"requestId":"a8cc6822bd4bbb4eb1b9e1b4996fbffuat1","loanApplications":[{"loanApplicationId":"a8cc6822bd4bbb4eb1b9e1b4996fbffuat1","lender":{"primaryId":"AWWPA7645M","primaryIdType":"PAN","additionalIdentifiers":[],"name":"HDFC BANK","category":"ORGANISATION","contactDetails":[],"documents":[]},"loanApplicationStatus":"PROCESSING"}]}';

const juspayJson = {
      'payload': 'eyJyZXF1ZXN0SWQiOiJKVVNlN2NlNjAwOWYwNjE0NGU2YWQ0ZDMwOWVkYzk3NTRhNCIsImxvYW5BcHBsaWNhdGlvbnMiOlt7Imd1YXJhbnRvcnMiOltdLCJsZW5kZXIiOm51bGwsImFwcGxpY2FudHMiOlt7ImNhdGVnb3J5IjoiSU5ESVZJRFVBTCIsInByaW1hcnlJZCI6Ijg4NjA0ODM3NDAiLCJyZWxhdGlvbnNoaXBXaXRoQm9ycm93ZXIiOm51bGwsImRvY3VtZW50cyI6W10sIm5hbWUiOm51bGwsImNvbnRhY3REZXRhaWxzIjpbXSwiYWRkaXRpb25hbElkZW50aWZpZXJzIjpbXSwicHJpbWFyeUlkVHlwZSI6Ik1PQklMRSJ9XSwidGVybXMiOnsicmVxdWVzdGVkQW1vdW50IjoiNTAwMDAiLCJ0ZW51cmUiOm51bGwsImludGVyZXN0VHlwZSI6bnVsbCwiY2hhcmdlcyI6bnVsbCwiYWNjb3VudCI6bnVsbCwiZG9jdW1lbnRzIjpudWxsLCJpbnRlcmVzdFJhdGUiOm51bGwsImN1cnJlbmN5IjoiSU5SIiwiaW50ZXJlc3RSYXRlVW5pdCI6bnVsbCwibGVnYWxBZ3JlZW1lbnQiOm51bGwsInNhbmN0aW9uZWRBbW91bnQiOm51bGwsImFjY291bnRUeXBlIjpudWxsfSwibG9hbkFwcGxpY2F0aW9uSWQiOiJKVVM4NjdjYzk3MWU0NmQ0ZmQzYTE3MjNjMjJhMjQyODIzMyIsInVybCI6bnVsbCwicHJvZHVjdFR5cGUiOiJDQVNIRkxPVyIsImNyZWF0ZWREYXRlIjoiMjAyMC0wOS0wM1QxMjoyMTo1My45MTk1MTE1ODlaIiwiYWN0aW9uUmVxdWlyZWQiOm51bGwsInBsZWRnZWREb2N1bWVudHMiOlt7InVybCI6bnVsbCwidmFsdWF0aW9uIjp7InVybCI6bnVsbCwidmFsdWUiOiI1MDAwMCIsImRhdGUiOiIyMDIwLTA5LTAzVDEyOjIxOjUzLjg5ODI4NDc4N1oiLCJjdXJyZW5jeSI6IklOUiIsInNvdXJjZSI6IjUwMDAwIiwiZXh0ZW5zaWJsZURhdGEiOm51bGx9LCJwcmltYXJ5SWQiOiJQdXJjaGFzZU9yZGVyMTIzIiwiZG9jdW1lbnRzIjpbeyJzb3VyY2VUeXBlIjoiR0VNIiwiZGF0YSI6ImV5SnBaQ0k2SWtwVlV6ZzRPVFEyTkdFd056QTJPVFJoWlROaU5tRmhPVEU1TWpBek1Ua3pNVm96SWl3aWMyVnNiR1Z5WDJsa0lqb2lTbFZUT0RnNU5EWTBZVEEzTURZNU5HRmxNMkkyWVdFNU1Ua3lNRE14T0RFMFJqRWlMQ0p6Wld4c1pYSmZjR0Z1SWpvaVFVRkNRMHN6TWpjelFpSXNJbk5sYkd4bGNsOXZibUp2WVhKa2FXNW5YMlJoZEdVaU9pSXlNREl3TFRBNExUSXhJREV3T2pJMU9qSTRJaXdpYm5WdFltVnlYMjltWDI5eVpHVnljMTl3YkdGalpXUWlPakV3TENKMllXeDFaVjl2Wmw5dmNtUmxjbk5mY0d4aFkyVmtJam9pTXpBd01EQXdJaXdpYm5WdFltVnlYMjltWDI5eVpHVnljMTlrWld4cGRtVnlaV1FpT2pVc0luWmhiSFZsWDI5bVgyOXlaR1Z5YzE5a1pXeHBkbVZ5WldRaU9pSXlNREF3TURBaUxDSjJZV3gxWlY5dlpsOXZjbVJsY25OZmNHRnBaQ0k2TkN3aVltRnVhMTloWTJOdmRXNTBYMjUxYldKbGNpSTZJakV3TURBd01DSXNJbUpoYm10ZllXTmpiM1Z1ZEY5cFpuTmpJam9pVTBGTlVFeEZYMGxHVTBNaUxDSmhZMk52ZFc1MFgyaHZiR1JsY2w5dVlXMWxJam9pUVVKRFgwdDFiV0Z5SWl3aWNIVnlZMmhoYzJWZmIzSmtaWEpmYm5WdFltVnlJam9pVUhWeVkyaGhjMlZQY21SbGNqRXlNeUlzSW1OdmJuUnlZV04wWDJSaGRHVWlPaUl5TURJd0xUQTRMVEl4SWl3aVluVjVaWEpmWjNOMGFXNGlPaUpDVlZsRlVsOUhVMVJKVGlJc0ltSjFlV1Z5WDNCaGJpSTZJa0pWV1VWU1gxQkJUaUlzSW5ObGJHeGxjbDluYzNScGJpSTZJbE5GVEV4RlVsOUhVMVJKVGlJc0ltOXlaR1Z5WDJGalkyVndkR0Z1WTJWZlpHRjBaU0k2SWpJd01qQXRNRGd0TWpFZ01UQTZNalU2TWpnaUxDSnZjbVJsY2w5aGJXOTFiblFpT2lJMU1EQXdNQ0lzSW1WNGNHVmpkR1ZrWDJSbGJHbDJaWEo1WDNOMFlYSjBYMlJoZEdVaU9pSXlNREl3TFRBNExUSTVJREV3T2pJMU9qSTRJaXdpWlhod1pXTjBaV1JmWkdWc2FYWmxjbmxmWlc1a1gyUmhkR1VpT2lJeU1ESXdMVEE0TFRNd0lERXdPakkxT2pJNElpd2liR2x1WlY5cGRHVnRjeUk2SWx0ZElpd2lZblY1WlhKZmNHRjViV1Z1ZEY5dFpYUm9iMlFpT2lKUVJrMVRJbjA9Iiwic291cmNlSWQiOiJHRU1fU0FIQVkiLCJyZWZlcmVuY2UiOiJKVVNiMzk3MmI4MGIyYzc0ZmI2YmQ5MTRjMDVjM2EzNjZiMSIsImZvcm1hdCI6IkpTT04iLCJ0eXBlIjoiR0VNX1BVUkNIQVNFX09SREVSIiwiaXNEYXRhSW5saW5lIjp0cnVlfV0sInR5cGUiOiJJTlZPSUNFIiwiZXh0ZW5zaWJsZURhdGEiOm51bGwsImRlc2NyaXB0aW9uIjpudWxsLCJwcmltYXJ5SWRUeXBlIjoiR0VNX1BVUkNIQVNFX09SREVSIn1dLCJsb2FuQXBwbGljYXRpb25TdGF0dXMiOm51bGwsImJvcnJvd2VyIjp7ImNhdGVnb3J5IjoiT1JHQU5JWkFUSU9OIiwidXJsIjpudWxsLCJwcmltYXJ5SWQiOiJBQUJDSzMyNzNCIiwiZG9jdW1lbnRzIjpbeyJzb3VyY2VUeXBlIjoiTUVSQ0hBTlQiLCJkYXRhIjoiZXlKd1lXNGlPaUpCVjFKVFFURXlNelJOSWl3aVozTjBhVzRpT201MWJHd3NJbTl1WW05aGNtUnBibWRFWVhSbElqb2lNakF5TUMwd01TMHhPU0lzSW5ObGJHeGxjbEpoZEdsdVp5STZleUpqYjNabGNtRm5aU0k2SWpRaUxDSjBhVzFsYkhsRVpXeHBkbVZ5ZVNJNklqUXVNaUlzSW5GMVlXeHBkSGxQWms5eVpHVnlSblZzWm1sc2JHMWxiblFpT2lJekxqZ2lMQ0p5Wld4cFlXSnBiR2wwZVNJNklqVWlMQ0pwYm1OcFpHVnVkRWhwYzNSdmNua2lPaUl4SWl3aWIzWmxjbUZzYkZKaGRHbHVaeUk2SWpJdU5UVWlmU3dpZG1sdWRHRm5aVVJoZEdFaU9uc2ljR1Z5YVc5a0lqb2lPVEJFSWl3aWJuVnRZbVZ5VDJaUGNtUmxjbk5RYkdGalpXUWlPaUl4TUNJc0luWmhiSFZsVDJaUGNtUmxjbk5RYkdGalpXUWlPaUl4TURBd01EQWlMQ0p1ZFcxaVpYSlBaazl5WkdWeWMwUmxiR2wyWlhKbFpDSTZJamdpTENKMllXeDFaVTltVDNKa1pYSnpSR1ZzYVhabGNtVmtJam9pT0RBd01EQWlMQ0oyWVd4MVpVOW1UM0prWlhKelVHRnBaQ0k2SWpVd01EQXdNQ0o5ZlE9PSIsInNvdXJjZUlkIjoiQUFCQ0szMjczQiIsInJlZmVyZW5jZSI6IiIsImZvcm1hdCI6IkpTT04iLCJ0eXBlIjoiR0VNX1BST0ZJTEUiLCJpc0RhdGFJbmxpbmUiOnRydWV9LHsic291cmNlVHlwZSI6IkdTVE4iLCJkYXRhIjoiZXlKemRHcERaQ0k2SWtkQk1EQTFJaXdpWkhSNUlqb2lVbVZuZFd4aGNpSXNJbXhuYm0waU9pSkJRa01nVUZKSlZrRlVSU0JNU1UxSlZFVkVJaXdpYzNScUlqb2lRa05RSUV0UFJFbExUMDVFUVNJc0ltRmtZV1J5SWpwYlhTd2lZM2hrZENJNklpSXNJbWR6ZEdsdUlqb2lNRFZCUWs1VVdUTXlPVEJRT0ZwQklpd2libUpoSWpwYklrWmhZM1J2Y25rZ0x5Qk5ZVzUxWm1GamRIVnlhVzVuSWwwc0lteHpkSFZ3WkhRaU9pSXdOaTh3TXk4eU1ESXdJaXdpWTNSaUlqb2lVSEpwZG1GMFpTQk1hVzFwZEdWa0lFTnZiWEJoYm5raUxDSnlaMlIwSWpvaU1ERXZNRGN2TWpBeE55SXNJbkJ5WVdSeUlqcDdJbUZrWkhJaU9uc2lZbTV0SWpvaVJVeFFTRWxPVTFSUFRrVWdRbFZKVEVSSlRrY2lMQ0p6ZENJNklqRXdMQ0JXUlVWU0lFNUJVa2xOUVU0Z1VrOUJSQ0lzSW14dll5STZJa1pQVWxRaUxDSmlibThpT2lJeE1DSXNJbk4wWTJRaU9pSlNZV3BoYzNSb1lXNGlMQ0prYzNRaU9pSWlMQ0pqYVhSNUlqb2lJaXdpWm14dWJ5STZJaUlzSW14MElqb2lJaXdpY0c1alpDSTZJalF3TURBd01TSXNJbXhuSWpvaUluMHNJbTUwY2lJNklrWmhZM1J2Y25rZ0x5Qk5ZVzUxWm1GamRIVnlhVzVuSW4wc0ltTjBha05rSWpvaVZVWXdNVEF5SWl3aWRISmhaR1ZPWVcwaU9pSkJRa01nVUZaVUxpQk1WRVF1TGlJc0luTjBjeUk2SWtGamRHbDJaU0lzSW1OMGFpSTZJbEpCVGtkRkxVbEpMVkJKVEVWU1RrVWlmUT09Iiwic291cmNlSWQiOiIzMEFBQkNLMzI3M0IxWjkiLCJyZWZlcmVuY2UiOiIiLCJmb3JtYXQiOiJKU09OIiwidHlwZSI6IkdTVE5fUFJPRklMRSIsImlzRGF0YUlubGluZSI6dHJ1ZX1dLCJuYW1lIjpudWxsLCJjb250YWN0RGV0YWlscyI6W10sImlkIjoiSlVTZTg3YmIwZjEwNWI1NGVjY2I4OWEyYWMwNjYzN2Y4MTIiLCJleHRlbnNpYmxlRGF0YSI6bnVsbCwiYWRkaXRpb25hbElkZW50aWZpZXJzIjpbXSwicHJpbWFyeUlkVHlwZSI6IlBBTiJ9LCJyZWplY3Rpb25EZXRhaWxzIjpudWxsLCJjb2xsYXRlcmFscyI6W10sIm9mZmVycyI6bnVsbCwiZXh0ZW5zaWJsZURhdGEiOm51bGwsInByb2R1Y3RJZCI6IlBVUkNIQVNFX09SREVSX0ZJTkFOQ0lORyIsImRlc2NyaXB0aW9uIjpudWxsLCJreWMiOm51bGx9XSwibWV0YWRhdGEiOnsidHJhY2VJZCI6IkpVUzY4ZDk5NzBjNWE3OTQzOTViNjhmZjIyZjM1YWFhYTM0Iiwib3JnSWQiOiJMU1AwMDciLCJ2ZXJzaW9uIjoiMC4xLjAiLCJ0aW1lc3RhbXAiOiIyMDIwLTA5LTAzVDEyOjIxOjUzLjkzMTg3MjQxM1oifX0=',
      'protected': 'eyJhbGciOiJSUzUxMiIsImtpZCI6InRDeVhRdFltZVFEQWhFS0tQY3JmRlF6aGdwcVBwREh5In0=',
      'signature': 'LjBsFcR2m67WhdUrvgqWGpAxMjmu1lJbaWCbeKND62m4duwNk1XSp1zdc6rB/y8ebNL9J8LmlysndXLvBxvnophAp0EcS1x0G0XtFlqzw26XVnrbooIwcAhS1r0vDGnxgqoo5TatEPi589UWjf4WhG61kUqe/U52iofI/xNmi0kIbNjqPRgs/1Pv3zm67Fk4AD1i02fKlAjHTSNc+3xueF56hCz17hvTYdn2TbStzwl71cyRvphSfCNThEgzIGITBQypzAzKwQpzFJ/E84vwHQBWUuw8+aXfJfr1tfUKVwvhDMlmEDqLOm0VxT1t0WrUk7faiyhA9vsjugZeSLqM+A==',
};

const justPayJSON_1= {
    'payload':'ewogICJtZXRhZGF0YSI6IHsKICAgICJ2ZXJzaW9uIjogIjMuMyIsCiAgICAidGltZXN0YW1wIjogIjIwMTgtMTItMDZUMTE6Mzk6NTcuMTUzWiIsCiAgICAidHJhY2VJZCI6ICJhOGNjNjgyMmJkNGJiYjRlYjFiOWUxYjQ5OTZmYmZmdWF0MSIsCiAgICAib3JnSWQiOiAiTFNQMTIzIgogIH0sCiAgInJlcXVlc3RJZCI6ICJhOGNjNjgyMmJkNGJiYjRlYjFiOWUxYjQ5OTZmYmZmdWF0MSIsCiAgImxvYW5BcHBsaWNhdGlvbnMiOiBbCiAgICB7CiAgICAgICJjcmVhdGVkRGF0ZSI6ICIyMDIwLTAzLTAxVDAwOjAwOjAwWiIsCiAgICAgICJsb2FuQXBwbGljYXRpb25JZCI6ICJhOGNjNjgyMmJkNGJiYjRlYjFiOWUxYjQ5OTZmYmZmdWF0MSIsCiAgICAgICJwcm9kdWN0VHlwZSI6ICJDQVNIRkxPVyIsCiAgICAgICJwcm9kdWN0SWQiOiAiSU5WT0lDRV9GSU5BTkNJTkciLAogICAgICAiYm9ycm93ZXIiOiB7CiAgICAgICAgInByaW1hcnlJZCI6ICJBQ0NQSjkxNzFEIiwKICAgICAgICAicHJpbWFyeUlkVHlwZSI6ICJQQU4iLAogICAgICAgICJhZGRpdGlvbmFsSWRlbnRpZmllcnMiOiBbXSwKICAgICAgICAiY2F0ZWdvcnkiOiAiT1JHQU5JWkFUSU9OIiwKICAgICAgICAiY29udGFjdERldGFpbHMiOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgICJ0eXBlIjogIlBSSU1BUlkiLAogICAgICAgICAgICAicGhvbmUiOiAiNzc3NzMzNzc3NyIsCiAgICAgICAgICAgICJlbWFpbCI6ICJqb2huZG9lQGRlZmVudGVycHJpc2VzIiwKICAgICAgICAgICAgImFkZHJlc3MiOiB7CiAgICAgICAgICAgICAgImNvIjogImNhcmUgb2YiLAogICAgICAgICAgICAgICJoYmEiOiAiSG91c2UtQnVpbGRpbmctQXBhcnRtZW50IiwKICAgICAgICAgICAgICAic3JsIjogIlN0cmVldC1Sb2FkLUxhbmUiLAogICAgICAgICAgICAgICJsYW5kbWFyayI6ICIiLAogICAgICAgICAgICAgICJhbHMiOiAiQXJlYS1Mb2NhbGl0eS1TZWN0b3IiLAogICAgICAgICAgICAgICJ2dGMiOiAiUFVORSIsCiAgICAgICAgICAgICAgInBpbkNvZGUiOiAiNDExMDAxIiwKICAgICAgICAgICAgICAicG8iOiAiIiwKICAgICAgICAgICAgICAiZGlzdHJpY3QiOiAiIiwKICAgICAgICAgICAgICAic3RhdGUiOiAiTUFIQVJBU0hUUkEiLAogICAgICAgICAgICAgICJjb3VudHJ5IjogIiIsCiAgICAgICAgICAgICAgInVyaSI6ICIiLAogICAgICAgICAgICAgICJsYXRpdHVkZSI6ICIiLAogICAgICAgICAgICAgICJsb25naXR1ZGUiOiAiIgogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICAiZG9jdW1lbnRzIjogWwogICAgICAgICAgewogICAgICAgICAgICAiZm9ybWF0IjogIkpTT04iLAogICAgICAgICAgICAicmVmZXJlbmNlIjogImI4Y2M2ODIyYmQ0YmJiNGViMWI5ZTFiNDk5NmZiZmY4YWNiIiwKICAgICAgICAgICAgInNvdXJjZVR5cGUiOiAiTUVSQ0hBTlQiLAogICAgICAgICAgICAic291cmNlSWQiOiAiR0VNIiwKICAgICAgICAgICAgInR5cGUiOiAiR0VNX1BST0ZJTEUiLAogICAgICAgICAgICAiaXNEYXRhSW5saW5lIjogdHJ1ZSwKICAgICAgICAgICAgImRhdGEiOiAiZXlKd1lXNGlPaUpCVjFKVFFURXlNelJOSWl3aVozTjBhVzRpT201MWJHd3NJbTl1WW05aGNtUnBibWRFWVhSbElqb2lNakF5TUMwd01TMHhPU0lzSW5ObGJHeGxjbEpoZEdsdVp5STZleUpqYjNabGNtRm5aU0k2SWpRaUxDSjBhVzFsYkhsRVpXeHBkbVZ5ZVNJNklqUXVNaUlzSW5GMVlXeHBkSGxQWms5eVpHVnlSblZzWm1sc2JHMWxiblFpT2lJekxqZ2lMQ0p5Wld4cFlXSnBiR2wwZVNJNklqVWlMQ0pwYm1OcFpHVnVkRWhwYzNSdmNua2lPaUl4SWl3aWIzWmxjbUZzYkZKaGRHbHVaeUk2SWpJdU5UVWlmU3dpZG1sdWRHRm5aVVJoZEdFaU9uc2ljR1Z5YVc5a0lqb2lPVEJFSWl3aWJuVnRZbVZ5VDJaUGNtUmxjbk5RYkdGalpXUWlPaUl4TUNJc0luWmhiSFZsVDJaUGNtUmxjbk5RYkdGalpXUWlPaUl4TURBd01EQWlMQ0p1ZFcxaVpYSlBaazl5WkdWeWMwUmxiR2wyWlhKbFpDSTZJamdpTENKMllXeDFaVTltVDNKa1pYSnpSR1ZzYVhabGNtVmtJam9pT0RBd01EQWlMQ0oyWVd4MVpVOW1UM0prWlhKelVHRnBaQ0k2SWpVd01EQXdNQ0o5ZlE9PSIKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgICJmb3JtYXQiOiAiSlNPTiIsCiAgICAgICAgICAgICJyZWZlcmVuY2UiOiAiYjhjYzY4MjJiZDRiYmI0ZWIxYjllMWI0OTk2ZmJmZjhhY2IiLAogICAgICAgICAgICAic291cmNlVHlwZSI6ICJHU1ROIiwKICAgICAgICAgICAgInNvdXJjZUlkIjogIkdTVE4iLAogICAgICAgICAgICAidHlwZSI6ICJHU1ROX1BST0ZJTEUiLAogICAgICAgICAgICAiaXNEYXRhSW5saW5lIjogdHJ1ZSwKICAgICAgICAgICAgImRhdGEiOiAiZXlKemRHcERaQ0k2SWtkQk1EQTFJaXdpWkhSNUlqb2lVbVZuZFd4aGNpSXNJbXhuYm0waU9pSkJRa01nVUZKSlZrRlVSU0JNU1UxSlZFVkVJaXdpYzNScUlqb2lRa05RSUV0UFJFbExUMDVFUVNJc0ltRmtZV1J5SWpwYlhTd2lZM2hrZENJNklpSXNJbWR6ZEdsdUlqb2lNRFZCUWs1VVdUTXlPVEJRT0ZwQklpd2libUpoSWpwYklrWmhZM1J2Y25rZ0x5Qk5ZVzUxWm1GamRIVnlhVzVuSWwwc0lteHpkSFZ3WkhRaU9pSXdOaTh3TXk4eU1ESXdJaXdpWTNSaUlqb2lVSEpwZG1GMFpTQk1hVzFwZEdWa0lFTnZiWEJoYm5raUxDSnlaMlIwSWpvaU1ERXZNRGN2TWpBeE55SXNJbkJ5WVdSeUlqcDdJbUZrWkhJaU9uc2lZbTV0SWpvaVJVeFFTRWxPVTFSUFRrVWdRbFZKVEVSSlRrY2lMQ0p6ZENJNklqRXdMQ0JXUlVWU0lFNUJVa2xOUVU0Z1VrOUJSQ0lzSW14dll5STZJa1pQVWxRaUxDSmlibThpT2lJeE1DSXNJbk4wWTJRaU9pSlNZV3BoYzNSb1lXNGlMQ0prYzNRaU9pSWlMQ0pqYVhSNUlqb2lJaXdpWm14dWJ5STZJaUlzSW14MElqb2lJaXdpY0c1alpDSTZJalF3TURBd01TSXNJbXhuSWpvaUluMHNJbTUwY2lJNklrWmhZM1J2Y25rZ0x5Qk5ZVzUxWm1GamRIVnlhVzVuSW4wc0ltTjBha05rSWpvaVZVWXdNVEF5SWl3aWRISmhaR1ZPWVcwaU9pSkJRa01nVUZaVUxpQk1WRVF1TGlJc0luTjBjeUk2SWtGamRHbDJaU0lzSW1OMGFpSTZJbEpCVGtkRkxVbEpMVkJKVEVWU1RrVWlmUT09IgogICAgICAgICAgfQogICAgICAgIF0KICAgICAgfSwKICAgICAgInBsZWRnZWREb2N1bWVudHMiOiBbCiAgICAgICAgewogICAgICAgICAgInByaW1hcnlJZCI6ICI8R0VNPl88SU5WT0lDRU5VTT4iLAogICAgICAgICAgInByaW1hcnlJZFR5cGUiOiAiR0VNX0lOVk9JQ0UiLAogICAgICAgICAgInR5cGUiOiAiSU5WT0lDRSIsCiAgICAgICAgICAiYWRkaXRpb25hbElkZW50aWZpZXJzIjogW10sCiAgICAgICAgICAicGFydGllcyI6IFtdLAogICAgICAgICAgImRvY3VtZW50cyI6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgICJmb3JtYXQiOiAiSlNPTiIsCiAgICAgICAgICAgICAgInJlZmVyZW5jZSI6ICJlOGNjNjgyMmJkNGJiYjRlYjFiOWUxYjQ5OTZmYmZmOGFjYiIsCiAgICAgICAgICAgICAgInNvdXJjZVR5cGUiOiAiTUVSQ0hBTlQiLAogICAgICAgICAgICAgICJzb3VyY2VJZCI6ICJHRU0iLAogICAgICAgICAgICAgICJ0eXBlIjogIkdFTV9JTlZPSUNFIiwKICAgICAgICAgICAgICAiaXNEYXRhSW5saW5lIjogdHJ1ZSwKICAgICAgICAgICAgICAiZGF0YSI6ICJleUp3ZFhKamFHRnpaVTl5WkdWeVRuVnRZbVZ5SWpvaVVFOHhNak0wSWl3aWMyVnNiR1Z5U1c1MmIybGpaVTUxYldKbGNpSTZJa2xPVmpFeU16UWlMQ0p6Wld4c1pYSkpiblp2YVdObFJHRjBaU0k2SWpJd01qQXRNRFF0TURFaUxDSmlkWGxsY2tkVFZFbE9Jam9pTWpsQlFrTkVRVEV5TXpSTk1WbzFJaXdpWW5WNVpYSlFRVTRpT2lKQlFrTkVRVEV5TXpSTklpd2ljMlZzYkdWeVIxTlVTVTRpT2lJeU9VRlhVbE5CTVRJek5FMHhXallpTENKcGJuWnZhV05sUVcxdmRXNTBJam9pTVRBd01EQXdJaXdpYVc1MmIybGpaVUZqWTJWd2RHRnVZMlZFWVhSbElqb2lNakF5TUMwd05DMHhPU0lzSW1OeVlXTk9kVzFpWlhJaU9pSkRVa0ZETVRJek5DSXNJbXhwYm1WSmRHVnRjeUk2VzNzaWNISnZaSFZqZEU1aGJXVWlPaUpQYm1sa1lTQlVWaUlzSW1kemRFRnRiM1Z1ZENJNklqRXdNREF3TUNJc0ltaHpia052WkdVaU9tNTFiR3dzSW5OaFkwTnZaR1VpT201MWJHd3NJbk5vYVhCd1pXUlJkV0Z1ZEdsMGVTSTZJalVpTENKaFkyTmxjSFJsWkZGMVlXNTBhWFI1SWpvaU5TSXNJbkpsYW1WamRHVmtVWFZoYm5ScGRIa2lPaUl3SW4xZGZRPT0iCiAgICAgICAgICAgIH0KICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIF0sCiAgICAgICJndWFyYW50b3JzIjogW10sCiAgICAgICJhcHBsaWNhbnRzIjogWwogICAgICAgIHsKICAgICAgICAgICJwcmltYXJ5SWQiOiAiOTg5ODk4OTg5OCIsCiAgICAgICAgICAicHJpbWFyeUlkVHlwZSI6ICJNT0JJTEUiCiAgICAgICAgfQogICAgICBdLAogICAgICAidGVybXMiOiB7CiAgICAgICAgInJlcXVlc3RlZEFtb3VudCI6ICI1MDAwMC4wMCIsCiAgICAgICAgImN1cnJlbmN5IjogIklOUiIKICAgICAgfQogICAgfQogIF0KfQ==',
    'header': 'eyJhbGciOiJSUzUxMiIsImtpZCI6InRDeVhRdFltZVFEQWhFS0tQY3JmRlF6aGdwcVBwREh5In0=',
    'signature': 'LjBsFcR2m67WhdUrvgqWGpAxMjmu1lJbaWCbeKND62m4duwNk1XSp1zdc6rB/y8ebNL9J8LmlysndXLvBxvnophAp0EcS1x0G0XtFlqzw26XVnrbooIwcAhS1r0vDGnxgqoo5TatEPi589UWjf4WhG61kUqe/U52iofI/xNmi0kIbNjqPRgs/1Pv3zm67Fk4AD1i02fKlAjHTSNc+3xueF56hCz17hvTYdn2TbStzwl71cyRvphSfCNThEgzIGITBQypzAzKwQpzFJ/E84vwHQBWUuw8+aXfJfr1tfUKVwvhDMlmEDqLOm0VxT1t0WrUk7faiyhA9vsjugZeSLqM+A=='
}

const justPayJSON_2= {
  'payload':'eyJtZXRhZGF0YSI6eyJ2ZXJzaW9uIjoiMy4zIiwidGltZXN0YW1wIjoiMjAyMC0xMi0wNlQxMTozOTo1Ny4xNTNaIiwidHJhY2VJZCI6ImM5Y2M2ODIyYmQ0YmJiNGViMWI5ZTFiNDk5NmZiZmY5YmRjIiwib3JnSWQiOiI0NWI3M2U2ZjBmYjk1NDhjMGdkNzlkNmc2Y2U0YmRjYSJ9LCJyZXF1ZXN0SWQiOiJiOWNjNjgyMmJkNGJiYjRlYjFiOWUxYjQ5OTZmYmZmOWJkYyIsImxvYW5BcHBsaWNhdGlvbnMiOlt7ImNyZWF0ZWREYXRlIjoiMjAyMC0wMy0wMVQwMDowMDowMFoiLCJsb2FuQXBwbGljYXRpb25JZCI6ImI5Y2M2ODIyYmQ0YmJiNGViMWI5ZTFiNDk5NmZiZmY5YmRjIiwicHJvZHVjdFR5cGUiOiJDQVNIRkxPVyIsInByb2R1Y3RJZCI6IklOVk9JQ0VfRklOQU5DSU5HIiwiYm9ycm93ZXIiOnsicHJpbWFyeUlkIjoiQUNDUEo5MTcxRCIsInByaW1hcnlJZFR5cGUiOiJQQU4iLCJhZGRpdGlvbmFsSWRlbnRpZmllcnMiOltdLCJjYXRlZ29yeSI6Ik9SR0FOSVpBVElPTiIsImNvbnRhY3REZXRhaWxzIjpbeyJ0eXBlIjoiUFJJTUFSWSIsInBob25lIjoiNzc3NzMzNzc3NyIsImVtYWlsIjoiam9obmRvZUBkZWZlbnRlcnByaXNlcyIsImFkZHJlc3MiOnsiY28iOiJjYXJlIG9mIiwiaGJhIjoiSG91c2UtQnVpbGRpbmctQXBhcnRtZW50Iiwic3JsIjoiU3RyZWV0LVJvYWQtTGFuZSIsImxhbmRtYXJrIjoiIiwiYWxzIjoiQXJlYS1Mb2NhbGl0eS1TZWN0b3IiLCJ2dGMiOiJQVU5FIiwicGluQ29kZSI6IjQxMTAwMSIsInBvIjoiIiwiZGlzdHJpY3QiOiIiLCJzdGF0ZSI6Ik1BSEFSQVNIVFJBIiwiY291bnRyeSI6IiIsInVyaSI6IiIsImxhdGl0dWRlIjoiIiwibG9uZ2l0dWRlIjoiIn19XSwiZG9jdW1lbnRzIjpbeyJmb3JtYXQiOiJKU09OIiwicmVmZXJlbmNlIjoiYjhjYzY4MjJiZDRiYmI0ZWIxYjllMWI0OTk2ZmJmZjhhY2IiLCJzb3VyY2VUeXBlIjoiTUVSQ0hBTlQiLCJzb3VyY2VJZCI6IkdFTSIsInR5cGUiOiJHRU1fUFJPRklMRSIsImlzRGF0YUlubGluZSI6dHJ1ZSwiZGF0YSI6ImV5SndZVzRpT2lKQlYxSlRRVEV5TXpSTklpd2laM04wYVc0aU9tNTFiR3dzSW05dVltOWhjbVJwYm1kRVlYUmxJam9pTWpBeU1DMHdNUzB4T1NJc0luTmxiR3hsY2xKaGRHbHVaeUk2ZXlKamIzWmxjbUZuWlNJNklqUWlMQ0owYVcxbGJIbEVaV3hwZG1WeWVTSTZJalF1TWlJc0luRjFZV3hwZEhsUFprOXlaR1Z5Um5Wc1ptbHNiRzFsYm5RaU9pSXpMamdpTENKeVpXeHBZV0pwYkdsMGVTSTZJalVpTENKcGJtTnBaR1Z1ZEVocGMzUnZjbmtpT2lJeElpd2liM1psY21Gc2JGSmhkR2x1WnlJNklqSXVOVFVpZlN3aWRtbHVkR0ZuWlVSaGRHRWlPbnNpY0dWeWFXOWtJam9pT1RCRUlpd2liblZ0WW1WeVQyWlBjbVJsY25OUWJHRmpaV1FpT2lJeE1DSXNJblpoYkhWbFQyWlBjbVJsY25OUWJHRmpaV1FpT2lJeE1EQXdNREFpTENKdWRXMWlaWEpQWms5eVpHVnljMFJsYkdsMlpYSmxaQ0k2SWpnaUxDSjJZV3gxWlU5bVQzSmtaWEp6UkdWc2FYWmxjbVZrSWpvaU9EQXdNREFpTENKMllXeDFaVTltVDNKa1pYSnpVR0ZwWkNJNklqVXdNREF3TUNKOWZRPT0ifSx7ImZvcm1hdCI6IkpTT04iLCJyZWZlcmVuY2UiOiJiOGNjNjgyMmJkNGJiYjRlYjFiOWUxYjQ5OTZmYmZmOGFjYiIsInNvdXJjZVR5cGUiOiJHU1ROIiwic291cmNlSWQiOiJHU1ROIiwidHlwZSI6IkdTVE5fUFJPRklMRSIsImlzRGF0YUlubGluZSI6dHJ1ZSwiZGF0YSI6ImV5SnpkR3BEWkNJNklrZEJNREExSWl3aVpIUjVJam9pVW1WbmRXeGhjaUlzSW14bmJtMGlPaUpCUWtNZ1VGSkpWa0ZVUlNCTVNVMUpWRVZFSWl3aWMzUnFJam9pUWtOUUlFdFBSRWxMVDA1RVFTSXNJbUZrWVdSeUlqcGJYU3dpWTNoa2RDSTZJaUlzSW1kemRHbHVJam9pTURWQlFrNVVXVE15T1RCUU9GcEJJaXdpYm1KaElqcGJJa1poWTNSdmNua2dMeUJOWVc1MVptRmpkSFZ5YVc1bklsMHNJbXh6ZEhWd1pIUWlPaUl3Tmk4d015OHlNREl3SWl3aVkzUmlJam9pVUhKcGRtRjBaU0JNYVcxcGRHVmtJRU52YlhCaGJua2lMQ0p5WjJSMElqb2lNREV2TURjdk1qQXhOeUlzSW5CeVlXUnlJanA3SW1Ga1pISWlPbnNpWW01dElqb2lSVXhRU0VsT1UxUlBUa1VnUWxWSlRFUkpUa2NpTENKemRDSTZJakV3TENCV1JVVlNJRTVCVWtsTlFVNGdVazlCUkNJc0lteHZZeUk2SWtaUFVsUWlMQ0ppYm04aU9pSXhNQ0lzSW5OMFkyUWlPaUpTWVdwaGMzUm9ZVzRpTENKa2MzUWlPaUlpTENKamFYUjVJam9pSWl3aVpteHVieUk2SWlJc0lteDBJam9pSWl3aWNHNWpaQ0k2SWpRd01EQXdNU0lzSW14bklqb2lJbjBzSW01MGNpSTZJa1poWTNSdmNua2dMeUJOWVc1MVptRmpkSFZ5YVc1bkluMHNJbU4wYWtOa0lqb2lWVVl3TVRBeUlpd2lkSEpoWkdWT1lXMGlPaUpCUWtNZ1VGWlVMaUJNVkVRdUxpSXNJbk4wY3lJNklrRmpkR2wyWlNJc0ltTjBhaUk2SWxKQlRrZEZMVWxKTFZCSlRFVlNUa1VpZlE9PSJ9XX0sInBsZWRnZWREb2N1bWVudHMiOlt7InByaW1hcnlJZCI6IjxHRU0-XzxJTlZPSUNFTlVNPiIsInByaW1hcnlJZFR5cGUiOiJHRU1fSU5WT0lDRSIsInR5cGUiOiJJTlZPSUNFIiwiYWRkaXRpb25hbElkZW50aWZpZXJzIjpbXSwicGFydGllcyI6W10sImRvY3VtZW50cyI6W3siZm9ybWF0IjoiSlNPTiIsInJlZmVyZW5jZSI6ImU4Y2M2ODIyYmQ0YmJiNGViMWI5ZTFiNDk5NmZiZmY4YWNiIiwic291cmNlVHlwZSI6Ik1FUkNIQU5UIiwic291cmNlSWQiOiJHRU0iLCJ0eXBlIjoiR0VNX0lOVk9JQ0UiLCJpc0RhdGFJbmxpbmUiOnRydWUsImRhdGEiOiJleUp3ZFhKamFHRnpaVTl5WkdWeVRuVnRZbVZ5SWpvaVVFOHhNak0wSWl3aWMyVnNiR1Z5U1c1MmIybGpaVTUxYldKbGNpSTZJa2xPVmpFeU16UWlMQ0p6Wld4c1pYSkpiblp2YVdObFJHRjBaU0k2SWpJd01qQXRNRFF0TURFaUxDSmlkWGxsY2tkVFZFbE9Jam9pTWpsQlFrTkVRVEV5TXpSTk1WbzFJaXdpWW5WNVpYSlFRVTRpT2lKQlFrTkVRVEV5TXpSTklpd2ljMlZzYkdWeVIxTlVTVTRpT2lJeU9VRlhVbE5CTVRJek5FMHhXallpTENKcGJuWnZhV05sUVcxdmRXNTBJam9pTVRBd01EQXdJaXdpYVc1MmIybGpaVUZqWTJWd2RHRnVZMlZFWVhSbElqb2lNakF5TUMwd05DMHhPU0lzSW1OeVlXTk9kVzFpWlhJaU9pSkRVa0ZETVRJek5DSXNJbXhwYm1WSmRHVnRjeUk2VzNzaWNISnZaSFZqZEU1aGJXVWlPaUpQYm1sa1lTQlVWaUlzSW1kemRFRnRiM1Z1ZENJNklqRXdNREF3TUNJc0ltaHpia052WkdVaU9tNTFiR3dzSW5OaFkwTnZaR1VpT201MWJHd3NJbk5vYVhCd1pXUlJkV0Z1ZEdsMGVTSTZJalVpTENKaFkyTmxjSFJsWkZGMVlXNTBhWFI1SWpvaU5TSXNJbkpsYW1WamRHVmtVWFZoYm5ScGRIa2lPaUl3SW4xZGZRPT0ifV19XSwiZ3VhcmFudG9ycyI6W10sImFwcGxpY2FudHMiOlt7InByaW1hcnlJZCI6Ijk4OTg5ODk4OTgiLCJwcmltYXJ5SWRUeXBlIjoiTU9CSUxFIn1dLCJ0ZXJtcyI6eyJyZXF1ZXN0ZWRBbW91bnQiOiI1MDAwMC4wMCIsImN1cnJlbmN5IjoiSU5SIn19XX0',
  'header': 'eyJhbGciOiJSUzUxMiIsImtpZCI6ImEwMTE1Y2I4LTBkM2EtMTFlYi1hZGMxLTAyNDJhYzEyMDAwMiJ9',
  'signature': 'PGpDciXCTEJMrxvXvQL-hnoAnty_YEy9Hi5y54atql8l5M7tEkFLCDrovlGHlan05kElSWfC2lPVzbysLGK8mbaO1zjf-TV_rDNVuoDdWAuDJOiipeKwmGx53nTy3UdCYDBczTfvUFuxw_5qJOTy7N2uzunkYa4FaWcALz8I9MTG8n0s919S7dZ7wgYi-JMAaQpdPtyOU6DQ6hKmNGZebcC9Hjfr54hLxARU5XEcMMml71DhRWgW9SWUjmqedquqXrey8gfppJjv3ieqCmc6qsjb_BQm4a7Quv4pVxakGKk45XSf1wKml17BoIlOKDn7Qy90afma9HqT1KkFB0_1Ig'
}
// header: {"alg":"RS512","kid":"tCyXQtYmeQDAhEKKPcrfFQzhgpqPpDHy"}

// verify wih public key of juspay
keystore.add(penetolabsPublicKey, "pem", {alg : 'RS512', kid : "a0115cb8-0d3a-11eb-adc1-0242ac120002"}).
then(function(result) {
    console.log("result :: ",result);

    jose.JWS.createVerify(keystore)
        .verify(justPayJSON_2)
        .then(function(verificationRes) {
          console.log("verification result 2::", verificationRes);
        }).catch(function(e) {
          console.log("verification result 2 failed");
            console.log(e);
        });

});